class Hamburger{components={size:{},stuffing:[],topping:[]};static SIZE_SMALL={components:["bun_top","hamburger","bun_bottom"],price:50,kcal:20};static SIZE_LARGE={components:["bun_top","hamburger","hamburger2","bun_bottom"],price:100,kcal:40};static STUFFING_CHEESE={components:["cheese"],price:10,kcal:20};static STUFFING_SALAD={components:["salad"],price:20,kcal:5};static STUFFING_TOMATO={components:["tomato"],price:15,kcal:10};static STUFFING_ONION={components:["onion"],price:5,kcal:5};static STUFFING_PINEAPPLE={components:["pineapple"],price:25,kcal:25};static TOPPING_SAUCE={components:["sauce"],price:15,kcal:0};static TOPPING_MAYO={components:["mayo"],price:20,kcal:5};changeSize(t){this.components.size=t}addTopping(t){this.components.topping.push(t)}deleteTopping(n){this.components.topping=this.components.topping.filter(t=>t!==n)}addStaffing(t){this.components.stuffing.push(t)}deleteStaffing(n){this.components.stuffing=this.components.stuffing.filter(t=>t!==n)}calculateCalories(){let t=0;for(var n in this.components)Array.isArray(this.components[n])?t+=this.components[n].reduce((t,n)=>t+n.kcal,0):t+=this.components[n].kcal;return t}calculatePrice(){let t=0;for(var n in this.components)Array.isArray(this.components[n])?t+=this.components[n].reduce((t,n)=>t+n.price,0):t+=this.components[n].price;return t}}
let $extra_box=document.getElementById("extra_box"),$review=document.getElementById("hamburger_review"),hamburgerForm=document.forms.hamburger,$main=document.querySelector("main"),$price=document.getElementById("price"),$calories=document.getElementById("calories"),$quantity=document.getElementById("quantity"),hamburger=new Hamburger;function cloneElementsToReview(e){e.forEach(e=>{e=document.querySelector(`[alt="${e}"]`).cloneNode(!0);$review.append(e)})}function deleteElementsFromReview(e){e.forEach(e=>{e=$review.querySelector(`[alt="${e}"]`);e&&e.remove()})}function changeValueByStep(e,t,r){let a=+t.textContent,n=a<e,m=setInterval(()=>{a===e&&clearInterval(m),t.textContent=a+"",n?a++:a--},r)}hamburgerForm.addEventListener("change",e=>{var t,r=e.target.value,r=("size"===e.target.name?(hamburger.changeSize(Hamburger[r]),deleteElementsFromReview(Hamburger.SIZE_LARGE.components),cloneElementsToReview(Hamburger[r].components),$main.classList.add("size-selected")):(t=e.target.getAttribute("data-component"),"stuffing"===e.target.name&&(e.target.checked?hamburger.addStaffing(Hamburger[r]):hamburger.deleteStaffing(Hamburger[r])),"topping"===e.target.name&&(e.target.checked?hamburger.addTopping(Hamburger[r]):hamburger.deleteTopping(Hamburger[r])),e.target.checked?cloneElementsToReview([t],$review):deleteElementsFromReview([t],$extra_box)),+hamburgerForm.quantity.value);changeValueByStep(hamburger.calculatePrice()*r,$price,5),changeValueByStep(hamburger.calculateCalories()*r,$calories,5)}),hamburgerForm.addEventListener("submit",e=>{e.preventDefault(),$main.querySelector(".quantity_review").textContent="X"+hamburgerForm.quantity.value,$main.classList.add("completed")}),$quantity.addEventListener("click",e=>{let t=hamburgerForm.quantity.value;e.target.closest(".inc")&&(t++,$quantity.querySelector(".qty-val").textContent=t),e.target.closest(".dec")&&(1<t&&t--,$quantity.querySelector(".qty-val").textContent=t),hamburgerForm.quantity.value=t,hamburgerForm.dispatchEvent(new Event("change"))});